Thu Feb  6 22:18:51 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla P100-PCIE-12GB           On  |   00000000:03:00.0 Off |                    0 |
| N/A   29C    P0             24W /  250W |       0MiB /  12288MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
WARNING: infoROM is corrupted at gpu 0000:03:00.0
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: nvflare~=2.5.0rc in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from -r requirements.txt (line 1)) (2.5.2)
Requirement already satisfied: torch in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from -r requirements.txt (line 2)) (2.5.1+computecanada)
Requirement already satisfied: torchvision in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from -r requirements.txt (line 3)) (0.20.1+computecanada)
Requirement already satisfied: tensorboard in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from -r requirements.txt (line 4)) (2.17.1+computecanada)
Requirement already satisfied: monai in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from -r requirements.txt (line 5)) (1.4.0+computecanada)
Requirement already satisfied: tqdm in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from -r requirements.txt (line 6)) (4.67.1+computecanada)
Requirement already satisfied: nibabel in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from -r requirements.txt (line 7)) (5.3.2)
Requirement already satisfied: cryptography>=36.0.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (44.0.0+computecanada)
Requirement already satisfied: Flask==3.0.2 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (3.0.2+computecanada)
Requirement already satisfied: Werkzeug==3.0.3 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (3.0.3+computecanada)
Requirement already satisfied: Flask-JWT-Extended==4.6.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (4.6.0)
Requirement already satisfied: Flask-SQLAlchemy==3.1.1 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (3.1.1)
Requirement already satisfied: SQLAlchemy==2.0.16 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (2.0.16+computecanada)
Requirement already satisfied: grpcio>=1.62.1 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (1.67.0+computecanada)
Requirement already satisfied: gunicorn>=22.0.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (23.0.0+computecanada)
Requirement already satisfied: numpy<2.0.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (1.26.4+computecanada)
Requirement already satisfied: protobuf>=4.24.4 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (5.29.3+computecanada)
Requirement already satisfied: psutil>=5.9.1 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (6.1.1+computecanada)
Requirement already satisfied: PyYAML>=6.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (6.0.2+computecanada)
Requirement already satisfied: requests>=2.28.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (2.32.3+computecanada)
Requirement already satisfied: six>=1.15.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (1.17.0+computecanada)
Requirement already satisfied: msgpack>=1.0.3 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (1.1.0+computecanada)
Requirement already satisfied: docker>=6.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (7.1.0)
Requirement already satisfied: websockets>=10.4 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (14.2)
Requirement already satisfied: pyhocon in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nvflare~=2.5.0rc->-r requirements.txt (line 1)) (0.3.61)
Requirement already satisfied: Jinja2>=3.1.2 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from Flask==3.0.2->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (3.1.5+computecanada)
Requirement already satisfied: itsdangerous>=2.1.2 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from Flask==3.0.2->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (2.2.0+computecanada)
Requirement already satisfied: click>=8.1.3 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from Flask==3.0.2->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (8.1.8+computecanada)
Requirement already satisfied: blinker>=1.6.2 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from Flask==3.0.2->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (1.9.0+computecanada)
Requirement already satisfied: PyJWT<3.0,>=2.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from Flask-JWT-Extended==4.6.0->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (2.10.1+computecanada)
Requirement already satisfied: typing-extensions>=4.2.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from SQLAlchemy==2.0.16->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (4.12.2+computecanada)
Requirement already satisfied: greenlet!=0.4.17 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from SQLAlchemy==2.0.16->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (3.1.1+computecanada)
Requirement already satisfied: MarkupSafe>=2.1.1 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from Werkzeug==3.0.3->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (2.1.5+computecanada)
Requirement already satisfied: filelock in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from torch->-r requirements.txt (line 2)) (3.17.0+computecanada)
Requirement already satisfied: networkx in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from torch->-r requirements.txt (line 2)) (3.4.2+computecanada)
Requirement already satisfied: fsspec in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from torch->-r requirements.txt (line 2)) (2025.2.0+computecanada)
Requirement already satisfied: sympy==1.13.1 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from torch->-r requirements.txt (line 2)) (1.13.1+computecanada)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from sympy==1.13.1->torch->-r requirements.txt (line 2)) (1.3.0+computecanada)
Requirement already satisfied: pillow-simd!=8.3.*,>=5.3.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from torchvision->-r requirements.txt (line 3)) (9.5.0.post2+computecanada)
Requirement already satisfied: absl-py>=0.4 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from tensorboard->-r requirements.txt (line 4)) (2.1.0+computecanada)
Requirement already satisfied: markdown>=2.6.8 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from tensorboard->-r requirements.txt (line 4)) (3.7+computecanada)
Requirement already satisfied: packaging in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from tensorboard->-r requirements.txt (line 4)) (24.2+computecanada)
Requirement already satisfied: setuptools>=41.0.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from tensorboard->-r requirements.txt (line 4)) (65.5.0)
Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from tensorboard->-r requirements.txt (line 4)) (0.7.2+computecanada)
Requirement already satisfied: importlib-resources>=5.12 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from nibabel->-r requirements.txt (line 7)) (6.5.2+computecanada)
Requirement already satisfied: cffi>=1.12 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from cryptography>=36.0.0->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (1.17.1+computecanada)
Requirement already satisfied: urllib3>=1.26.0 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from docker>=6.0->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (2.3.0+computecanada)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from requests>=2.28.0->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (3.4.1+computecanada)
Requirement already satisfied: idna<4,>=2.5 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from requests>=2.28.0->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (3.10+computecanada)
Requirement already satisfied: certifi>=2017.4.17 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from requests>=2.28.0->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (2025.1.31+computecanada)
Requirement already satisfied: pyparsing<4,>=2 in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from pyhocon->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (3.2.1+computecanada)
Requirement already satisfied: pycparser in /home/psaha03/scratch/safeseg/env/lib/python3.11/site-packages (from cffi>=1.12->cryptography>=36.0.0->nvflare~=2.5.0rc->-r requirements.txt (line 1)) (2.22+computecanada)
2025-02-06 22:18:56,178 - SimulatorRunner - INFO - Create the Simulator Server.
2025-02-06 22:18:56,185 - CoreCell - INFO - server: creating listener on tcp://0:43269
2025-02-06 22:18:56,306 - CoreCell - INFO - server: created backbone external listener for tcp://0:43269
2025-02-06 22:18:56,307 - ConnectorManager - INFO - 3059122: Try start_listener Listener resources: {'secure': False, 'host': 'localhost'}
2025-02-06 22:18:56,309 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connector [CH00002 PASSIVE tcp://0:56110] is starting
2025-02-06 22:18:56,810 - CoreCell - INFO - server: created backbone internal listener for tcp://localhost:56110
2025-02-06 22:18:56,812 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connector [CH00001 PASSIVE tcp://0:43269] is starting
2025-02-06 22:18:56,814 - SimulatorServer - INFO - max_reg_duration=60.0
2025-02-06 22:18:56,933 - nvflare.fuel.hci.server.hci - INFO - Starting Admin Server localhost on Port 35005
2025-02-06 22:18:56,933 - SimulatorRunner - INFO - Deploy the Apps.
2025-02-06 22:18:57,003 - SimulatorRunner - INFO - Create the simulate clients.
2025-02-06 22:18:57,011 - Communicator - INFO - Trying to register with server ...
2025-02-06 22:18:57,012 - ClientManager - INFO - authenticated client site-1
2025-02-06 22:18:57,013 - ClientManager - INFO - Client: New client site-1@172.16.136.245 joined. Sent token: 1132bf46-d078-4092-bc43-ef2f517842e2.  Total clients: 1
2025-02-06 22:18:57,013 - Communicator - INFO - register RC: ok
2025-02-06 22:18:57,014 - FederatedClient - INFO - Successfully registered client:site-1 for project simulator_server. Token:1132bf46-d078-4092-bc43-ef2f517842e2 SSID:
2025-02-06 22:18:57,015 - SimulatorRunner - INFO - Set the client status ready.
2025-02-06 22:18:57,015 - SimulatorRunner - INFO - Deploy and start the Server App.
2025-02-06 22:18:57,020 - Cell - INFO - Register blob CB for channel='server_command', topic='*'
2025-02-06 22:18:57,021 - Cell - INFO - Register blob CB for channel='aux_communication', topic='*'
2025-02-06 22:18:57,022 - ServerCommandAgent - INFO - ServerCommandAgent cell register_request_cb: server.simulate_job
2025-02-06 22:19:10,552 - IntimeModelSelector - INFO - model selection weights control: None
2025-02-06 22:19:10,561 - AuxRunner - INFO - registered aux handler for topic __sync_runner__
2025-02-06 22:19:10,561 - AuxRunner - INFO - registered aux handler for topic __job_heartbeat__
2025-02-06 22:19:10,562 - AuxRunner - INFO - registered aux handler for topic __task_check__
2025-02-06 22:19:10,563 - AuxRunner - INFO - registered aux handler for topic RM.RELIABLE_REQUEST
2025-02-06 22:19:10,564 - AuxRunner - INFO - registered aux handler for topic RM.RELIABLE_REPLY
2025-02-06 22:19:10,565 - ReliableMessage - INFO - enabled reliable message: max_request_workers=20 query_interval=2.0
2025-02-06 22:19:10,565 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job]: Server runner starting ...
2025-02-06 22:19:10,567 - AuxRunner - INFO - registered aux handler for topic fed.event
2025-02-06 22:19:10,567 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job]: starting workflow scatter_and_gather (<class 'nvflare.app_common.workflows.scatter_and_gather.ScatterAndGather'>) ...
2025-02-06 22:19:10,568 - ScatterAndGather - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Initializing ScatterAndGather workflow.
2025-02-06 22:19:10,568 - PTFileModelPersistor - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Both source_ckpt_file_full_name and ckpt_preload_path are not provided. Using the default model weights initialized on the persistor side.
2025-02-06 22:19:10,570 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Workflow scatter_and_gather (<class 'nvflare.app_common.workflows.scatter_and_gather.ScatterAndGather'>) started
2025-02-06 22:19:10,571 - ScatterAndGather - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Beginning ScatterAndGather training phase.
2025-02-06 22:19:10,572 - ScatterAndGather - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Round 0 started.
2025-02-06 22:19:10,572 - WFCommServer - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: scheduled task train
2025-02-06 22:19:11,031 - SimulatorClientRunner - INFO - Start the clients run simulation.
2025-02-06 22:19:12,033 - SimulatorClientRunner - INFO - Simulate Run client: site-1 on GPU group: 0
2025-02-06 22:19:14,061 - ClientTaskWorker - INFO - ClientTaskWorker started to run
2025-02-06 22:19:14,228 - CoreCell - INFO - site-1.simulate_job: created backbone external connector to tcp://localhost:43269
2025-02-06 22:19:14,229 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connector [CH00001 ACTIVE tcp://localhost:43269] is starting
2025-02-06 22:19:14,231 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00002 127.0.0.1:59298 => 127.0.0.1:43269] is created: PID: 3059146
2025-02-06 22:19:14,231 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00004 127.0.0.1:43269 <= 127.0.0.1:59298] is created: PID: 3059122
2025-02-06 22:19:31,837 - AuxRunner - INFO - registered aux handler for topic __end_run__
2025-02-06 22:19:31,838 - AuxRunner - INFO - registered aux handler for topic __do_task__
2025-02-06 22:19:31,839 - Cell - INFO - Register blob CB for channel='aux_communication', topic='*'
2025-02-06 22:19:32,353 - Cell - INFO - broadcast: channel='aux_communication', topic='__sync_runner__', targets=['server.simulate_job'], timeout=2.0
2025-02-06 22:19:32,359 - ClientRunner - INFO - [identity=site-1, run=simulate_job]: synced to Server Runner in 0.5067481994628906 seconds
2025-02-06 22:19:32,360 - AuxRunner - INFO - registered aux handler for topic RM.RELIABLE_REQUEST
2025-02-06 22:19:32,361 - AuxRunner - INFO - registered aux handler for topic RM.RELIABLE_REPLY
2025-02-06 22:19:32,361 - ReliableMessage - INFO - enabled reliable message: max_request_workers=20 query_interval=2.0
2025-02-06 22:19:32,362 - AuxRunner - INFO - registered aux handler for topic fed.event
2025-02-06 22:19:32,363 - ClientRunner - INFO - [identity=site-1, run=simulate_job]: client runner started
2025-02-06 22:19:32,364 - ClientTaskWorker - INFO - Initialize ClientRunner for client: site-1
2025-02-06 22:19:32,367 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, task_name=train, task_id=ad2857b5-e94f-4968-abf8-3cdeab770b88]: assigned task to client site-1: name=train, id=ad2857b5-e94f-4968-abf8-3cdeab770b88
2025-02-06 22:19:32,368 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, task_name=train, task_id=ad2857b5-e94f-4968-abf8-3cdeab770b88]: sent task assignment to client. client_name:site-1 task_id:ad2857b5-e94f-4968-abf8-3cdeab770b88
2025-02-06 22:19:32,369 - GetTaskCommand - INFO - return task to client.  client_name: site-1  task_name: train   task_id: ad2857b5-e94f-4968-abf8-3cdeab770b88  sharable_header_task_id: ad2857b5-e94f-4968-abf8-3cdeab770b88
2025-02-06 22:19:32,466 - Communicator - INFO - Received from simulator_server server. getTask: train size: 18.8MB (18833681 Bytes) time: 0.101051 seconds
2025-02-06 22:19:32,467 - FederatedClient - INFO - pull_task completed. Task name:train Status:True 
2025-02-06 22:19:32,468 - ClientRunner - INFO - [identity=site-1, run=simulate_job, peer=simulator_server, peer_run=simulate_job]: got task assignment: name=train, id=ad2857b5-e94f-4968-abf8-3cdeab770b88
2025-02-06 22:19:32,469 - ClientRunner - INFO - [identity=site-1, run=simulate_job, peer=simulator_server, peer_run=simulate_job, task_name=train, task_id=ad2857b5-e94f-4968-abf8-3cdeab770b88]: invoking task executor LearnerExecutor
2025-02-06 22:19:32,470 - LearnerExecutor - INFO - [identity=site-1, run=simulate_job, peer=simulator_server, peer_run=simulate_job, task_name=train, task_id=ad2857b5-e94f-4968-abf8-3cdeab770b88]: Client trainer got task: train
2025-02-06 22:19:32,471 - SupervisedMonaiBratsLearner - INFO - [identity=site-1, run=simulate_job, peer=simulator_server, peer_run=simulate_job, task_name=train, task_id=ad2857b5-e94f-4968-abf8-3cdeab770b88]: Client site-1 initialized with args: 
 Namespace(job_folder='/scratch/psaha03/safeseg/src/./configs/brats_central', workspace='/home/psaha03/scratch/workspace_brats/brats_central/site-1', clients=None, n_clients=1, threads=1, gpu='0', max_clients=100, set=['secure_train=False'], log_config=None, config_folder='config', job_id='simulate_job', client_config='config/config_fed_client.json', env='config/environment.json', end_run_for_all=False, sp_target='0:43269', sp_scheme='tcp', client_name='site-1', token='1132bf46-d078-4092-bc43-ef2f517842e2')
2025-02-06 22:19:32,500 - SupervisedMonaiBratsLearner - INFO - [identity=site-1, run=simulate_job, peer=simulator_server, peer_run=simulate_job, task_name=train, task_id=ad2857b5-e94f-4968-abf8-3cdeab770b88]: Training Size: 957, Validation Size: 393
